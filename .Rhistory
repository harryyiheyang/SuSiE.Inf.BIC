fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:6))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
library(devtools)
library(dplyr)
Lvec=c(0:6)
load_all()
data("LD")
LD=bdiag(LD[[1]],LD[[2]],LD[[3]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.001/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:6))
library(devtools)
library(dplyr)
Lvec=c(0:6)
load_all()
data("LD")
LD=bdiag(LD[[1]],LD[[2]],LD[[3]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.001/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:6))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
library(devtools)
library(dplyr)
Lvec=c(0:6)
load_all()
data("LD")
LD=bdiag(LD[[1]],LD[[2]],LD[[3]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.001/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:6))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
library(devtools)
library(dplyr)
Lvec=c(0:6)
load_all()
data("LD")
LD=bdiag(LD[[1]],LD[[2]],LD[[3]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.001/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:6))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
library(devtools)
library(dplyr)
Lvec=c(0:6)
load_all()
data("LD")
LD=bdiag(LD[[1]],LD[[2]],LD[[3]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.001/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:6))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.001/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:6))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
fit_susie_inf$alpha
fit_susie_inf$var.inf
fit_susie_inf$pv
library(devtools)
library(dplyr)
Lvec=c(0:6)
load_all()
data("LD")
LD=bdiag(LD[[1]],LD[[2]],LD[[3]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.001/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:6))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
barplot(beta_susie)
barplot(beta_susie_inf)
cbind(beta_susie,beta)
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.001/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:6))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
library(devtools)
library(dplyr)
Lvec=c(0:6)
load_all()
data("LD")
LD=bdiag(LD[[1]],LD[[2]],LD[[3]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.001/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.001/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
library(devtools)
library(dplyr)
load_all()
data("LD")
LD=bdiag(LD[[1]],LD[[2]],LD[[3]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=5e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
beta=rnorm(m,0,1)
beta[-sample(m,3)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
library(devtools)
library(dplyr)
load_all()
data("LD")
LD=bdiag(LD[[1]],LD[[2]],LD[[3]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,2)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
library(devtools)
library(dplyr)
load_all()
data("LD")
i=round(runif(1,10));j=round(runif(1,10));k=round(runif(1,10));j
LD=bdiag(LD[[i]],LD[[j]],LD[[k]])%>%as.matrix(.)
library(devtools)
library(dplyr)
load_all()
data("LD")
i=round(runif(1,10));j=round(runif(1,10));k=round(runif(1,10))
LD=bdiag(LD[[i]],LD[[j]],LD[[k]])%>%as.matrix(.)
LD[[i]]
i
i=round(runif(1,1,10));j=round(runif(1,1,10));k=round(runif(1,1,10))
LD=bdiag(LD[[i]],LD[[j]],LD[[k]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,2)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
library(devtools)
library(dplyr)
load_all()
data("LD")
i=round(runif(1,1,10));j=round(runif(1,1,10));k=round(runif(1,1,10))
LD=bdiag(LD[[i]],LD[[j]],LD[[k]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,2)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
library(devtools)
library(dplyr)
load_all()
data("LD")
i=round(runif(1,1,10));j=round(runif(1,1,10));k=round(runif(1,1,10))
LD=bdiag(LD[[i]],LD[[j]],LD[[k]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,2)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(cor(beta_susie_inf,beta),cor(beta_susie,beta),cor(fit_susie_inf$alpha,alpha))
norm(beta_susie_inf-beta,"2")
beta_susie_inf-beta
norm(beta_susie_inf-beta,"2")
c(norm(beta_susie_inf-beta,"inf"),norm(beta_susie-beta,"2"),cor(fit_susie_inf$alpha,alpha))
sqrt(sum((beta_susie_inf-beta)^2))
sqrt(sum((beta_susie-beta)^2))
beta_susie_inf
library(devtools)
library(dplyr)
load_all()
data("LD")
i=round(runif(1,1,10));j=round(runif(1,1,10));k=round(runif(1,1,10))
LD=bdiag(LD[[i]],LD[[j]],LD[[k]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,2)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(sqrt(sum((beta_susie_inf-beta)^2)),sqrt(sum((beta_susie-beta)^2)),cor(fit_susie_inf$alpha,alpha))
beta_susie_inf
beta
library(devtools)
library(dplyr)
load_all()
data("LD")
i=round(runif(1,1,10));j=round(runif(1,1,10));k=round(runif(1,1,10))
LD=bdiag(LD[[i]],LD[[j]],LD[[k]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,2)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(sqrt(sum((beta_susie_inf-beta)^2)),sqrt(sum((beta_susie-beta)^2)),cor(fit_susie_inf$alpha,alpha))
library(devtools)
library(dplyr)
load_all()
data("LD")
i=round(runif(1,1,10));j=round(runif(1,1,10));k=round(runif(1,1,10))
LD=bdiag(LD[[i]],LD[[j]],LD[[k]])%>%as.matrix(.)
LDsqrt=matrixsqrt(LD)$w
m=nrow(LD)
beta=rnorm(m,0,1)
beta[-sample(m,2)]=0
beta=beta/sqrt(sum(beta^2))*sqrt(0.001)
alpha=rnorm(m,0,sqrt(0.0005/m))
n=2e5
hatb=matrixVectorMultiply(LD,beta+alpha)+matrixVectorMultiply(LDsqrt,rnorm(m,0,1/sqrt(n)))
z=hatb*sqrt(n)
fit_susie=susie_rss(z=z,R=LD,n=n,L=5)
beta_susie=coef(fit_susie)[-1]*(fit_susie$pip>0.5)
R=LD; Lvec = c(0:15);cred.thres = 0.95;pip.thres = 0.5;max.iter = 100;max.eps = 0.001;susie.iter = 500;reml.iter = 10;score.test = T;estimate_residual_variance = T;pv.thres = 0.05;eigen.thres = 1
fit_susie_inf=FastSuSiEInf(z=z,R=LD,n=n,Lvec=c(0:5))
beta_susie_inf=fit_susie_inf$beta
c(sqrt(sum((beta_susie_inf-beta)^2)),sqrt(sum((beta_susie-beta)^2)),cor(fit_susie_inf$alpha,alpha))
library(mgcv)
help(gam)
library(devtools)
document()
